{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\n\nexport function renderGallery(images) {\n  const gallery = document.querySelector(\".gallery\");\n  if (!gallery) {\n    console.error(\"Gallery container not found!\");\n    return;\n  }\n\n  const cards = images\n    .map(\n      (img) => `\n    <li class=\"gallery-item\">\n      <a href=\"${img.largeImageURL}\">\n        <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\">\n      </a>\n      <div class=\"info\">\n        <p><b>Likes:</b> ${img.likes}</p>\n        <p><b>Views:</b> ${img.views}</p>\n        <p><b>Comments:</b> ${img.comments}</p>\n        <p><b>Downloads:</b> ${img.downloads}</p>\n      </div>\n    </li>\n  `\n    )\n    .join(\"\");\n\n  gallery.insertAdjacentHTML(\"beforeend\", cards);\n\n  \n  lightbox.refresh();\n}\n\n\nexport function clearGallery() {\n  const gallery = document.querySelector(\".gallery\");\n  if (gallery) {\n    gallery.innerHTML = \"\";\n  }\n}\n\n\nexport function showLoader() {\n  const loader = document.querySelector(\".loader\");\n  if (loader) {\n    loader.classList.remove(\"hidden\");\n  }\n}\n\n\nexport function hideLoader() {\n  const loader = document.querySelector(\".loader\");\n  if (loader) {\n    loader.classList.add(\"hidden\");\n  }\n}\n\n\nexport function showLoadMoreButton() {\n  const btn = document.querySelector(\".load-more\");\n  if (btn) {\n    btn.classList.remove(\"hidden\");\n  }\n}\n\n\nexport function hideLoadMoreButton() {\n  const btn = document.querySelector(\".load-more\");\n  if (btn) {\n    btn.classList.add(\"hidden\");\n  }\n}","import axios from \"axios\";\n\nconst API_KEY = \"52507179-0a3bafb5b272d1890f0df5cc7\";\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst PER_PAGE = 15;\n\nconst api = axios.create({\n  baseURL: BASE_URL,\n  params: {\n    key: API_KEY,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n  },\n});\n\n/**\n * @param {string} query\n * @param {number} [page=1]\n * @param {number} [per_page=PER_PAGE]\n * @param {AbortSignal} [signal]\n * @returns {Promise<{hits: any[], totalHits: number}>}\n */\nexport async function getImagesByQuery(query, page = 1, per_page = PER_PAGE, signal) {\n  try {\n    if (!query || typeof query !== \"string\" || query.trim() === \"\") {\n      return { hits: [], totalHits: 0 };\n    }\n    const { data } = await api.get(\"\", {\n      params: { q: query, page, per_page },\n      signal,\n    });\n\n    const hits = Array.isArray(data?.hits) ? data.hits : [];\n    const totalHits = Number.isFinite(data?.totalHits) ? data.totalHits : 0;\n\n    return { hits, totalHits };\n  } catch (error) {\n    if (axios.isCancel?.(error)) throw error;\n    console.error(\"Pixabay API error:\", error?.message || error);\n    throw error;\n  }\n}","import { renderGallery, clearGallery, showLoader, hideLoader } from './js/render-functions.js';\nimport { getImagesByQuery } from './js/pixabay-api.js';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst form = document.querySelector(\".form\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\n\nlet currentQuery = \"\";\nlet currentPage = 1;\nlet totalHits = 0;\nconst PER_PAGE = 15;\n\nform.addEventListener(\"submit\", async (e) => {\n  e.preventDefault();\n\n  currentQuery = form.elements[\"search-text\"].value.trim();\n  currentPage = 1; \n  clearGallery();\n  loadMoreBtn.classList.add(\"hidden\");\n\n  if (!currentQuery) {\n    iziToast.error({ title: \"Error\", message: \"Enter a search term!\" });\n    return;\n  }\n\n  await fetchImages();\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  currentPage += 1; \n  await fetchImages(true); \n});\n\nasync function fetchImages(doScroll = false) {\n  try {\n    showLoader();\n\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    if (!data.hits || data.hits.length === 0) {\n      if (currentPage === 1) {\n        iziToast.show({\n          message: \"Sorry, there are no images matching your search query.<br>Please try again!\",\n          position: \"topRight\",\n          timeout: 4000,\n          close: true,\n          progressBar: false,\n          backgroundColor: \"#f44336\",\n          messageColor: \"#fff\",\n          layout: 2,\n          maxWidth: 420,\n          class: \"custom-toast\",\n          icon: \"fa fa-times-circle\"\n        });\n      }\n      loadMoreBtn.classList.add(\"hidden\");\n      return;\n    }\n\n    renderGallery(data.hits);\n    totalHits = data.totalHits;\n\n    const totalPages = Math.ceil(totalHits / PER_PAGE);\n\n    if (currentPage < totalPages) {\n      loadMoreBtn.classList.remove(\"hidden\");\n    } else {\n      loadMoreBtn.classList.add(\"hidden\");\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n        timeout: 4000\n      });\n    }\n\n\n    if (doScroll) {\n      const galleryItem = document.querySelector(\".gallery-item\");\n      if (galleryItem) {\n        const { height: cardHeight } = galleryItem.getBoundingClientRect();\n        window.scrollBy({\n          top: cardHeight * 2,\n          behavior: \"smooth\"\n        });\n      }\n    }\n\n  } catch (error) {\n    iziToast.error({ title: \"Error\", message: \"Failed to fetch images. Try later!\" });\n    console.error(\"API Error:\", error);\n  } finally {\n    hideLoader();\n  }\n}"],"names":["lightbox","SimpleLightbox","renderGallery","images","gallery","cards","img","clearGallery","showLoader","loader","hideLoader","API_KEY","BASE_URL","PER_PAGE","api","axios","getImagesByQuery","query","page","per_page","signal","data","hits","totalHits","error","_b","_a","form","loadMoreBtn","currentQuery","currentPage","iziToast","fetchImages","doScroll","totalPages","galleryItem","cardHeight"],"mappings":"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"}